{"version":3,"sources":["DataContext.ts","UserReference.tsx","Util.ts","arrow-up.svg","PostSummary.tsx","PostList.tsx","BoardPage.tsx","white-axe.svg","Header.tsx","HomePage.tsx","Loading.tsx","LoginForm.tsx","NewBoard.tsx","NewPost.tsx","Page404.tsx","InputForm.tsx","ReplyForm.tsx","PostDetail.tsx","UserDetail.tsx","VoteSet.ts","App.tsx","serviceWorker.js","index.js"],"names":["DataContext","React","createContext","useDataContext","dc","useContext","Error","UserReference","props","username","react_default","a","createElement","react_router_dom","to","concat","publicKey","ago","date","helper","num","term","ms","Date","getTime","seconds","Math","floor","minutes","hours","days","months","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","arrow_up_ref2","fill","points","stroke","strokeMiterlimit","strokeWidth","arrow_up_SvgArrowUp","_ref","svgRef","enableBackground","id","viewBox","xmlSpace","ref","ForwardRef","forwardRef","__webpack_require__","p","VoteButton","data","button","useRef","style","direction","transform","Button","variant","active","currentVote","onClick","e","preventDefault","current","blur","app","upvote","postID","downvote","width","height","PostSummary","comments","post","numComments","commentsPhrase","board","boards","keyPair","pk","getPublicKey","owner","vote","votes","getVote","score","Card","marginTop","Container","Row","Col","xs","Body","Text","marginBottom","textAlign","getScore","Title","content","Subtitle","className","author","timestamp","name","PostList","posts","map","index","BoardPage","postlist","push","sort","b","white_axe_extends","white_axe_objectWithoutProperties","white_axe_objectWithoutPropertiesLoose","white_axe_ref2","white_axe_ref3","white_axe_SvgWhiteAxe","d","fillOpacity","white_axe_ForwardRef","LogInWidget","Nav","NavDropdown","title","Item","as","logout","lib","withRouter","Navbar","bg","Brand","location","pathname","HomePage","Link","Loading","LoginForm","_useState","useState","_useState2","slicedToArray","setUsername","_useState3","_useState4","passphrase","setPassphrase","react_router","onSubmit","login","alert","type","value","onChange","NewBoard","setName","description","setDescription","_useState5","_useState6","redirect","setRedirect","handleSubmit","asyncToGenerator","regenerator_default","mark","_callee","wrap","_context","prev","next","abrupt","console","log","createBoard","sent","stop","_x","replace","BoardDropDown","selected","undefined","onSelect","NewPost","setID","setContent","boardID","setBoardID","createPost","values","localeCompare","Page404","InputForm","ReplyForm","createComment","parent","PostDetail","cmap","comment","UserDetail","VoteSet","classCallCheck","karma","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","done","addVote","err","return","delta","abs","split","removeVote","modify","forget","App","_this","possibleConstructorReturn","getPrototypeOf","channel","postdb","commentdb","votedb","boarddb","axiom","Axiom","network","verbose","database","ageFilter","obj","age","useFilter","state","loading","loadData","setTimeout","window","localStorage","getItem","waitForLoad","find","selector","commentlist","_iterator2","_iteratorNormalCompletion2","_step2","votelist","boardlist","_iterator3","_iteratorNormalCompletion3","_step3","setState","args","create","newPosts","objectSpread","newCommentSubmap","newComments","newBoards","forceUpdate","test","KeyPair","fromSecretPhrase","setKeyPair","setItem","removeItem","src_DataContext","Provider","src_Header","path","render","match","params","_ref2","_ref3","_ref4","exact","Component","Boolean","hostname","ReactDOM","App_App","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.dc06fb24.chunk.js","sourcesContent":["import React, { useContext } from \"react\";\nimport { AxiomObject, KeyPair } from \"axiom-api\";\n\nimport App from \"./App\";\nimport VoteSet from \"./VoteSet\";\n\ntype ObjectMap = { [id: string]: AxiomObject };\ntype CommentMap = { [parent: string]: ObjectMap };\n\ntype DataContextType = {\n  app: App;\n  posts: ObjectMap;\n  comments: CommentMap;\n  votes: VoteSet;\n  boards: ObjectMap;\n  username?: string;\n  keyPair?: KeyPair;\n};\n\nconst DataContext = React.createContext<DataContextType | null>(null);\n\nexport default DataContext;\n\nexport function useDataContext(): DataContextType {\n  let dc = useContext(DataContext);\n  if (dc === null) {\n    throw new Error(\"null context causes trouble\");\n  }\n  return dc;\n}\n","import React from \"react\";\nimport { Link } from \"react-router-dom\";\n\nexport default function UserReference(props: {\n  username?: string;\n  publicKey: string;\n}) {\n  let username = props.username || \"anonymous\";\n  return <Link to={`/u/${username}/${props.publicKey}`}>{username}</Link>;\n}\n","// Creates a string like \"2 days ago\"\nexport function ago(date: Date): string {\n  let helper = (num: number, term: string) => {\n    if (num === 1) {\n      return `1 ${term} ago`;\n    }\n    return `${num} ${term}s ago`;\n  };\n\n  let now = new Date();\n  let ms = now.getTime() - date.getTime();\n  if (ms < 0) {\n    return \"in the future\";\n  }\n  if (ms < 1000) {\n    return \"just now\";\n  }\n  let seconds = Math.floor(ms / 1000);\n  if (seconds < 60) {\n    return helper(seconds, \"second\");\n  }\n  let minutes = Math.floor(seconds / 60);\n  if (minutes < 60) {\n    return helper(minutes, \"minute\");\n  }\n  let hours = Math.floor(minutes / 60);\n  if (hours < 24) {\n    return helper(hours, \"hour\");\n  }\n  let days = Math.floor(hours / 24);\n  if (days < 30) {\n    return helper(days, \"day\");\n  }\n  // This is a little bit inaccurate. Hopefully it's fine\n  let months = Math.floor(days / 30);\n  if (months < 12) {\n    return helper(months, \"month\");\n  }\n  let years = Math.floor(months / 12);\n  return helper(years, \"year\");\n}\n\nexport function daysAgo(date: Date): number {\n  let msPerDay = 1000 * 60 * 60 * 24;\n  let now = new Date();\n  let ms = now.getTime() - date.getTime();\n  return ms / msPerDay;\n}\n\nexport function isEmpty(obj: any): boolean {\n  for (let _key in obj) {\n    return false;\n  }\n  return true;\n}\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"polyline\", {\n  fill: \"none\",\n  points: \"3,15.5 12,6.5 21,15.5 \",\n  stroke: \"#000000\",\n  strokeMiterlimit: 10,\n  strokeWidth: 2\n});\n\nvar SvgArrowUp = function SvgArrowUp(_ref) {\n  var svgRef = _ref.svgRef,\n      props = _objectWithoutProperties(_ref, [\"svgRef\"]);\n\n  return React.createElement(\"svg\", _extends({\n    enableBackground: \"new 0 0 24 24\",\n    id: \"Layer_1\",\n    viewBox: \"0 0 24 24\",\n    xmlSpace: \"preserve\",\n    ref: svgRef\n  }, props), _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgArrowUp, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/arrow-up.622be8bd.svg\";\nexport { ForwardRef as ReactComponent };","import React, { useRef } from \"react\";\nimport { AxiomObject } from \"axiom-api\";\nimport { Link } from \"react-router-dom\";\n\nimport Button from \"react-bootstrap/Button\";\nimport Card from \"react-bootstrap/Card\";\nimport Col from \"react-bootstrap/Col\";\nimport Container from \"react-bootstrap/Container\";\nimport Row from \"react-bootstrap/Row\";\n\nimport { useDataContext } from \"./DataContext\";\nimport UserReference from \"./UserReference\";\nimport { ago } from \"./Util\";\nimport { ReactComponent as ArrowUp } from \"./arrow-up.svg\";\n\nfunction VoteButton(props: {\n  direction: number;\n  currentVote: number;\n  postID: string;\n}) {\n  let data = useDataContext();\n  let button = useRef<any>(null);\n\n  let style = props.direction < 0 ? { transform: \"scaleY(-1)\" } : {};\n\n  return (\n    <Button\n      ref={button}\n      variant=\"outline-secondary\"\n      active={props.direction * props.currentVote > 0}\n      onClick={(e: any) => {\n        e.preventDefault();\n        button.current.blur();\n        if (props.direction > 0) {\n          data.app.upvote(props.postID);\n        } else {\n          data.app.downvote(props.postID);\n        }\n      }}\n    >\n      <ArrowUp width=\"20\" height=\"20\" style={style} />\n    </Button>\n  );\n}\n\nexport default function PostSummary(props: { post: AxiomObject }) {\n  let data = useDataContext();\n  let comments = data.comments[props.post.id];\n  let numComments = comments ? Object.keys(comments).length : 0;\n  let commentsPhrase = `${numComments} comment${numComments === 1 ? \"\" : \"s\"}`;\n\n  let board = data.boards[props.post.data.board];\n\n  let currentVote = 0;\n  if (data.keyPair) {\n    let pk = data.keyPair.getPublicKey();\n    if (pk === props.post.owner) {\n      currentVote = 1;\n    } else {\n      let vote = data.votes.getVote(pk, props.post.id);\n      if (vote) {\n        currentVote = vote.data.score;\n      }\n    }\n  }\n\n  return (\n    <Card style={{ marginTop: \"10px\" }}>\n      <Container>\n        <Row>\n          <Col xs=\"auto\">\n            <Card.Body>\n              <VoteButton\n                direction={1}\n                currentVote={currentVote}\n                postID={props.post.id}\n              />\n              <Card.Text\n                style={{\n                  marginTop: \"0.5rem\",\n                  marginBottom: \"0.5rem\",\n                  textAlign: \"center\"\n                }}\n              >\n                {data.votes.getScore(props.post.id)}\n              </Card.Text>\n              <VoteButton\n                direction={-1}\n                currentVote={currentVote}\n                postID={props.post.id}\n              />\n            </Card.Body>\n          </Col>\n          <Col>\n            <Card.Body>\n              <Card.Title>{props.post.data.content}</Card.Title>\n              <Card.Subtitle className=\"mb-2 text-muted\">\n                posted by{\" \"}\n                <UserReference\n                  username={props.post.data.author}\n                  publicKey={props.post.owner}\n                />{\" \"}\n                {ago(props.post.timestamp)}\n                {board && [\n                  <span key={1}> in </span>,\n                  <Link key={2} to={`/b/${board.name}/${board.id}`}>{`b/${\n                    board.name\n                  }`}</Link>\n                ]}\n              </Card.Subtitle>\n              <Card.Text>\n                <Link to={`/post/${props.post.id}`}>{commentsPhrase}</Link>\n              </Card.Text>\n            </Card.Body>\n          </Col>\n        </Row>\n      </Container>\n    </Card>\n  );\n}\n","import React from \"react\";\nimport { AxiomObject } from \"axiom-api\";\n\nimport PostSummary from \"./PostSummary\";\n\nexport default function PostList(props: { posts: AxiomObject[] }) {\n  return (\n    <div>\n      {props.posts.map((post, index) => {\n        return <PostSummary key={index} post={post} />;\n      })}\n    </div>\n  );\n}\n","import React from \"react\";\nimport { Link } from \"react-router-dom\";\n\nimport { useDataContext } from \"./DataContext\";\nimport PostList from \"./PostList\";\n\nexport default function BoardPage(props: { id: string; name?: string }) {\n  let data = useDataContext();\n\n  let board = data.boards[props.id];\n  if (!board) {\n    return <div>board not found</div>;\n  }\n  if (props.name && props.name !== board.name) {\n    return <div>the board has been renamed</div>;\n  }\n\n  let postlist = [];\n  for (let id in data.posts) {\n    let post = data.posts[id];\n    if (post.data.board === props.id) {\n      postlist.push(post);\n    }\n  }\n  postlist.sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime());\n\n  return (\n    <div>\n      <h2>{\"b/\" + board.name}</h2>\n      <Link to={`/newpost/${board.id}`}>new post</Link>\n      <PostList posts={postlist} />\n    </div>\n  );\n}\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"metadata\", {\n  id: \"metadata65\"\n});\n\nvar _ref3 =\n/*#__PURE__*/\nReact.createElement(\"defs\", {\n  id: \"defs63\"\n});\n\nvar SvgWhiteAxe = function SvgWhiteAxe(_ref) {\n  var svgRef = _ref.svgRef,\n      props = _objectWithoutProperties(_ref, [\"svgRef\"]);\n\n  return React.createElement(\"svg\", _extends({\n    id: \"Axe\",\n    enableBackground: \"new 0 0 300 300\",\n    height: 289.06046,\n    viewBox: \"0 0 200.00008 169.37136\",\n    width: 341.33347,\n    ref: svgRef\n  }, props), _ref2, _ref3, React.createElement(\"g\", {\n    id: \"g58\",\n    transform: \"translate(-50.000375,-65.314644)\"\n  }, React.createElement(\"path\", {\n    d: \"M 247.884,132.889 209.346,98.9 211.05,97.197 c 6.492,-6.501 6.492,-17.074 -0.003,-23.575 -6.305,-6.312 -17.268,-6.312 -23.573,0 l -3.18,3.182 -11.255,-9.927 c -2.478,-2.179 -6.223,-2.069 -8.555,0.269 l -34.38,34.386 c -2.335,2.332 -2.451,6.08 -0.269,8.552 l 9.927,11.257 -84.893,84.893 c -6.492,6.501 -6.492,17.074 0.003,23.575 3.25,3.254 7.517,4.877 11.787,4.877 4.27,0 8.536,-1.63 11.787,-4.877 l 83.412,-83.415 33.985,38.536 c 1.218,1.386 2.939,2.118 4.691,2.118 0.989,0 1.99,-0.232 2.912,-0.72 9.65,-5.091 18.519,-11.641 26.354,-19.479 7.831,-7.832 14.384,-16.695 19.478,-26.353 1.347,-2.552 0.77,-5.696 -1.394,-7.607 z M 196.312,82.461 c 1.63,-1.624 4.27,-1.624 5.893,0 1.627,1.624 1.627,4.273 0.003,5.897 l -2.256,2.256 -6.266,-5.526 z m -27.141,-2.326 40.906,36.078 c -3.899,6.227 -8.459,12.025 -13.673,17.237 -5.213,5.213 -11.011,9.775 -17.239,13.672 L 143.092,106.218 Z M 69.606,220.97 c -1.63,1.624 -4.27,1.624 -5.893,0 -1.627,-1.624 -1.627,-4.273 -0.003,-5.897 l 84.336,-84.339 5.527,6.267 z M 220.96,158.009 c -5.777,5.775 -12.177,10.762 -19.081,14.87 l -14.316,-16.233 c 6.365,-4.154 12.291,-8.964 17.679,-14.356 5.393,-5.391 10.202,-11.316 14.354,-17.68 l 16.232,14.317 c -4.11,6.904 -9.097,13.307 -14.868,19.082 z\",\n    id: \"path56\",\n    style: {\n      fill: \"#ffffff\"\n    }\n  })), React.createElement(\"path\", {\n    style: {\n      fill: \"#ffffff\",\n      fillOpacity: 0,\n      strokeWidth: 0.24916942\n    },\n    d: \"M 14.452229,169.09346 C 9.5365704,168.45068 4.4575264,164.97858 2.1907698,160.71137 0.6732403,157.8546 0.2557569,156.1046 0.26973151,152.65878 0.28084089,149.9191 0.36553639,149.30449 0.97329421,147.5532 1.3533069,146.45817 2.0639079,144.8884 2.5524081,144.06482 3.2381313,142.90875 13.295863,132.70391 46.675463,99.296422 L 89.910344,56.025424 89.062123,55.045203 c -0.466517,-0.539115 -2.831016,-3.231322 -5.254447,-5.982673 -2.423426,-2.751358 -4.606928,-5.375684 -4.852225,-5.831842 -0.658424,-1.224416 -0.610435,-4.008891 0.09159,-5.314436 0.313424,-0.582867 8.017582,-8.45881 18.555721,-18.969474 19.931398,-19.87943012 18.887428,-18.98487348 21.843108,-18.71686566 0.79916,0.0724688 1.77955,0.30123046 2.17863,0.50836523 0.39909,0.20712891 3.40755,2.74434963 6.68546,5.63825973 l 5.95983,5.2616487 2.26276,-2.2140119 c 3.35319,-3.2809629 5.87188,-4.7107735 9.53185,-5.4110391 2.41381,-0.4618359 4.12951,-0.4519277 6.50802,0.037559 3.57279,0.7352988 6.79385,2.5340098 9.02039,5.0371582 2.44619,2.7501028 4.23738,7.4053358 4.23738,11.0127648 0,3.95751 -1.79672,8.338987 -4.71644,11.501508 -0.96908,1.049666 -1.76197,1.964344 -1.76197,2.032612 0,0.06827 8.84808,7.927494 19.6624,17.464933 21.70463,19.141904 20.80175,18.22169 20.79107,21.190242 -0.006,1.694754 -0.58628,3.017608 -3.35587,7.651606 -9.42167,15.764056 -22.805,29.099192 -38.59261,38.453632 -4.41091,2.61354 -5.60235,3.11792 -7.3505,3.11175 -2.06842,-0.007 -3.20396,-0.59898 -5.11115,-2.66325 -0.88904,-0.96225 -8.79251,-9.89252 -17.56327,-19.845066 L 111.88501,80.903053 69.277035,123.45293 c -32.529967,32.4856 -42.947355,42.74731 -44.042806,43.38462 -1.980985,1.15249 -4.236282,1.9304 -6.515772,2.24744 -2.106117,0.29294 -2.09083,0.29291 -4.266228,0.008 z m 3.948328,-12.47371 c 0.588744,-0.29737 85.137273,-84.701246 85.137273,-84.991613 0,-0.238928 -5.230504,-6.178664 -5.440902,-6.178664 -0.09207,0 -19.360981,19.201623 -42.819803,42.670267 -42.574389,42.59222 -42.652717,42.67241 -42.820975,43.84597 -0.270322,1.88546 0.631008,3.74983 2.182559,4.51456 0.944133,0.46535 2.968131,0.54039 3.761848,0.13948 z M 154.18424,106.27678 c 10.03105,-6.26575 20.00618,-15.657178 27.04422,-25.461711 1.83858,-2.56128 4.42874,-6.543194 4.57847,-7.03858 0.0738,-0.24429 -15.91744,-14.573479 -16.23038,-14.54345 -0.0734,0.007 -0.99758,1.271461 -2.05379,2.809817 -6.77988,9.874799 -16.26713,19.446064 -26.56831,26.803558 -1.55333,1.10945 -2.99711,2.113928 -3.20841,2.232176 -0.30525,0.17083 1.0888,1.885781 6.78574,8.347758 3.94344,4.473022 7.26658,8.132762 7.38473,8.132762 0.11814,0 1.13862,-0.57705 2.26773,-1.28233 z M 132.33703,79.868826 c 10.27529,-7.008978 18.84429,-15.573949 25.70386,-25.691771 l 2.16328,-3.190811 -0.86224,-0.84781 C 158.8677,49.672133 149.62472,41.486879 138.80198,31.948977 L 119.12426,14.607342 106.09405,27.632229 c -7.166614,7.163689 -13.000179,13.151883 -12.963476,13.307097 0.079,0.33412 35.873556,40.955332 36.088976,40.955332 0.0812,0 1.48403,-0.911625 3.11748,-2.025832 z m 19.22959,-56.111361 c 1.76222,-1.835168 2.23627,-3.052242 1.80815,-4.642178 -0.69393,-2.577035 -3.41319,-3.937517 -5.80424,-2.903935 -0.44099,0.190629 -1.52141,1.081617 -2.40094,1.979976 l -1.59914,1.633377 1.22538,1.095616 c 3.36386,3.007617 4.97668,4.397841 5.11031,4.40499 0.0811,0.0041 0.82828,-0.701192 1.66048,-1.567846 z\",\n    id: \"path67\"\n  }), React.createElement(\"path\", {\n    style: {\n      fill: \"#ffffff\",\n      fillOpacity: 0,\n      strokeWidth: 0.24916942\n    },\n    d: \"m 14.269264,169.07717 c -1.983018,-0.2963 -4.3930608,-1.16925 -6.2017163,-2.24634 -1.8112324,-1.07862 -4.4586926,-3.72608 -5.5373203,-5.53732 -3.07148144,-5.15763 -3.15724862,-11.57323 -0.2253574,-16.85732 0.5889973,-1.06154 10.55529,-11.1733 44.216409,-44.861776 l 43.456032,-43.49134 -5.269746,-5.968793 c -2.898358,-3.282837 -5.47912,-6.417298 -5.735028,-6.965472 -0.633914,-1.357887 -0.616447,-3.650572 0.03891,-5.107969 0.731151,-1.625918 35.434933,-36.3637206 37.220643,-37.2571347 1.55393,-0.77745117 3.52897,-0.81941601 5.09635,-0.10829296 0.60295,0.2735625 2.39697,1.64985356 3.98671,3.05842386 1.58974,1.4085761 4.27069,3.7804336 5.95768,5.2708066 l 3.06723,2.7097622 2.41449,-2.3965903 c 2.74756,-2.7271817 4.54267,-3.9016875 7.39788,-4.8402891 1.72278,-0.566332 2.41613,-0.6552773 5.10797,-0.6552773 2.69668,0 3.38211,0.08826 5.10798,0.6577383 4.27143,1.4094199 7.6755,4.3212773 9.56609,8.1828694 1.34187,2.740816 1.77112,4.543435 1.77112,7.437785 0,4.454719 -1.52379,8.199996 -4.68052,11.504109 -1.60368,1.678553 -1.83116,2.020875 -1.52942,2.301563 0.19495,0.181347 8.88839,7.848187 19.31877,17.037422 10.43037,9.189234 19.30052,17.115574 19.71143,17.614095 0.87503,1.061549 1.31595,2.369748 1.31595,3.904325 0,1.339769 -0.94134,3.381023 -3.61977,7.849341 -8.36797,13.959938 -20.3703,26.440334 -34.00481,35.359254 -3.28175,2.14673 -7.98354,4.88366 -9.42268,5.48497 -1.2522,0.5232 -3.35332,0.44852 -4.79187,-0.17033 -1.36333,-0.58649 0.30443,1.24062 -23.14099,-25.352026 L 111.82101,80.842174 68.933565,123.68819 c -42.066311,42.02568 -42.923227,42.86315 -44.756215,43.74054 -3.185332,1.52471 -6.758016,2.11911 -9.908104,1.64844 z m 4.264131,-12.55544 c 0.431841,-0.2051 19.782404,-19.37066 43.00125,-42.59011 l 42.216085,-42.21718 -1.70166,-1.948928 c -3.071812,-3.51818 -3.817166,-4.316039 -4.032029,-4.316039 -0.428578,0 -85.034619,84.857937 -85.289701,85.543637 -1.070912,2.87874 0.868939,5.90155 3.78726,5.90155 0.678498,0 1.586959,-0.16782 2.018795,-0.37293 z M 154.75836,105.90635 c 8.69352,-5.52614 16.95641,-13.010744 23.7101,-21.476832 2.25355,-2.824934 7.41987,-10.312283 7.41987,-10.75333 0,-0.370963 -16.24482,-14.506313 -16.42986,-14.296366 -0.10381,0.117797 -0.7336,0.999053 -1.3995,1.958356 -7.64671,11.015777 -17.01105,20.46798 -27.64406,27.903434 -1.50748,1.054148 -2.74087,2.0234 -2.74087,2.153888 0,0.344737 13.9037,16.1391 14.21888,16.15241 0.14596,0.006 1.43541,-0.73254 2.86544,-1.64156 z M 131.64124,80.356244 c 9.82795,-6.587244 18.57189,-15.068396 25.21709,-24.459211 1.1795,-1.666839 2.4145,-3.488484 2.74443,-4.048101 L 160.20265,50.83144 143.976,36.525008 C 135.05135,28.656471 125.82341,20.518584 123.46949,18.440815 l -4.27988,-3.777768 -13.12773,13.129488 -13.127735,13.129489 14.495265,16.43731 c 20.11535,22.810383 21.64732,24.535324 21.79038,24.535324 0.0694,0 1.15906,-0.692285 2.42145,-1.538414 z m 19.78139,-56.331187 c 1.54973,-1.592408 2.07367,-2.583352 2.07367,-3.921973 0,-2.248582 -1.61799,-4.000289 -3.86721,-4.18681 -1.71155,-0.141938 -2.61639,0.309603 -4.56968,2.280416 l -1.56194,1.575943 3.14633,2.780279 c 1.73048,1.529157 3.22719,2.780285 3.32603,2.780285 0.0988,0 0.75259,-0.588662 1.4528,-1.30814 z\",\n    id: \"path69\"\n  }), React.createElement(\"path\", {\n    style: {\n      fill: \"#ffffff\",\n      fillOpacity: 0,\n      strokeWidth: 0.24916942\n    },\n    d: \"m 14.269264,169.07717 c -1.983018,-0.2963 -4.3930608,-1.16925 -6.2017163,-2.24634 -1.8112324,-1.07862 -4.4586926,-3.72608 -5.5373203,-5.53732 -3.07148144,-5.15763 -3.15724862,-11.57323 -0.2253574,-16.85732 0.5889973,-1.06154 10.55529,-11.1733 44.216409,-44.861776 l 43.456032,-43.49134 -5.269746,-5.968793 c -2.898358,-3.282837 -5.47912,-6.417298 -5.735028,-6.965472 -0.633914,-1.357887 -0.616447,-3.650572 0.03891,-5.107969 0.731151,-1.625918 35.434933,-36.3637206 37.220643,-37.2571347 1.55393,-0.77745117 3.52897,-0.81941601 5.09635,-0.10829296 0.60295,0.2735625 2.39697,1.64985356 3.98671,3.05842386 1.58974,1.4085761 4.27069,3.7804336 5.95768,5.2708066 l 3.06723,2.7097622 2.41449,-2.3965903 c 2.74756,-2.7271817 4.54267,-3.9016875 7.39788,-4.8402891 1.72278,-0.566332 2.41613,-0.6552773 5.10797,-0.6552773 2.69668,0 3.38211,0.08826 5.10798,0.6577383 4.27143,1.4094199 7.6755,4.3212773 9.56609,8.1828694 1.34187,2.740816 1.77112,4.543435 1.77112,7.437785 0,4.454719 -1.52379,8.199996 -4.68052,11.504109 -1.60368,1.678553 -1.83116,2.020875 -1.52942,2.301563 0.19495,0.181347 8.88839,7.848187 19.31877,17.037422 10.43037,9.189234 19.30052,17.115574 19.71143,17.614095 0.87503,1.061549 1.31595,2.369748 1.31595,3.904325 0,1.339769 -0.94134,3.381023 -3.61977,7.849341 -8.36797,13.959938 -20.3703,26.440334 -34.00481,35.359254 -3.28175,2.14673 -7.98354,4.88366 -9.42268,5.48497 -1.2522,0.5232 -3.35332,0.44852 -4.79187,-0.17033 -1.36333,-0.58649 0.30443,1.24062 -23.14099,-25.352026 L 111.82101,80.842174 68.933565,123.68819 c -42.066311,42.02568 -42.923227,42.86315 -44.756215,43.74054 -3.185332,1.52471 -6.758016,2.11911 -9.908104,1.64844 z m 4.264131,-12.55544 c 0.431841,-0.2051 19.782404,-19.37066 43.00125,-42.59011 l 42.216085,-42.21718 -1.70166,-1.948928 c -3.071812,-3.51818 -3.817166,-4.316039 -4.032029,-4.316039 -0.428578,0 -85.034619,84.857937 -85.289701,85.543637 -1.070912,2.87874 0.868939,5.90155 3.78726,5.90155 0.678498,0 1.586959,-0.16782 2.018795,-0.37293 z M 154.75836,105.90635 c 8.69352,-5.52614 16.95641,-13.010744 23.7101,-21.476832 2.25355,-2.824934 7.41987,-10.312283 7.41987,-10.75333 0,-0.370963 -16.24482,-14.506313 -16.42986,-14.296366 -0.10381,0.117797 -0.7336,0.999053 -1.3995,1.958356 -7.64671,11.015777 -17.01105,20.46798 -27.64406,27.903434 -1.50748,1.054148 -2.74087,2.0234 -2.74087,2.153888 0,0.344737 13.9037,16.1391 14.21888,16.15241 0.14596,0.006 1.43541,-0.73254 2.86544,-1.64156 z M 131.64124,80.356244 c 9.82795,-6.587244 18.57189,-15.068396 25.21709,-24.459211 1.1795,-1.666839 2.4145,-3.488484 2.74443,-4.048101 L 160.20265,50.83144 143.976,36.525008 C 135.05135,28.656471 125.82341,20.518584 123.46949,18.440815 l -4.27988,-3.777768 -13.12773,13.129488 -13.127735,13.129489 14.495265,16.43731 c 20.11535,22.810383 21.64732,24.535324 21.79038,24.535324 0.0694,0 1.15906,-0.692285 2.42145,-1.538414 z m 19.78139,-56.331187 c 1.54973,-1.592408 2.07367,-2.583352 2.07367,-3.921973 0,-2.248582 -1.61799,-4.000289 -3.86721,-4.18681 -1.71155,-0.141938 -2.61639,0.309603 -4.56968,2.280416 l -1.56194,1.575943 3.14633,2.780279 c 1.73048,1.529157 3.22719,2.780285 3.32603,2.780285 0.0988,0 0.75259,-0.588662 1.4528,-1.30814 z\",\n    id: \"path71\"\n  }), React.createElement(\"path\", {\n    style: {\n      fill: \"#ffffff\",\n      fillOpacity: 0,\n      strokeWidth: 0.24916942\n    },\n    d: \"m 14.269264,169.07717 c -1.983018,-0.2963 -4.3930608,-1.16925 -6.2017163,-2.24634 -1.8112324,-1.07862 -4.4586926,-3.72608 -5.5373203,-5.53732 -3.07148144,-5.15763 -3.15724862,-11.57323 -0.2253574,-16.85732 0.5889973,-1.06154 10.55529,-11.1733 44.216409,-44.861776 l 43.456032,-43.49134 -5.269746,-5.968793 c -2.898358,-3.282837 -5.47912,-6.417298 -5.735028,-6.965472 -0.633914,-1.357887 -0.616447,-3.650572 0.03891,-5.107969 0.731151,-1.625918 35.434933,-36.3637206 37.220643,-37.2571347 1.55393,-0.77745117 3.52897,-0.81941601 5.09635,-0.10829296 0.60295,0.2735625 2.39697,1.64985356 3.98671,3.05842386 1.58974,1.4085761 4.27069,3.7804336 5.95768,5.2708066 l 3.06723,2.7097622 2.41449,-2.3965903 c 2.74756,-2.7271817 4.54267,-3.9016875 7.39788,-4.8402891 1.72278,-0.566332 2.41613,-0.6552773 5.10797,-0.6552773 2.69668,0 3.38211,0.08826 5.10798,0.6577383 4.27143,1.4094199 7.6755,4.3212773 9.56609,8.1828694 1.34187,2.740816 1.77112,4.543435 1.77112,7.437785 0,4.454719 -1.52379,8.199996 -4.68052,11.504109 -1.60368,1.678553 -1.83116,2.020875 -1.52942,2.301563 0.19495,0.181347 8.88839,7.848187 19.31877,17.037422 10.43037,9.189234 19.30052,17.115574 19.71143,17.614095 0.87503,1.061549 1.31595,2.369748 1.31595,3.904325 0,1.339769 -0.94134,3.381023 -3.61977,7.849341 -8.36797,13.959938 -20.3703,26.440334 -34.00481,35.359254 -3.28175,2.14673 -7.98354,4.88366 -9.42268,5.48497 -1.2522,0.5232 -3.35332,0.44852 -4.79187,-0.17033 -1.36333,-0.58649 0.30443,1.24062 -23.14099,-25.352026 L 111.82101,80.842174 68.933565,123.68819 c -42.066311,42.02568 -42.923227,42.86315 -44.756215,43.74054 -3.185332,1.52471 -6.758016,2.11911 -9.908104,1.64844 z m 4.264131,-12.55544 c 0.431841,-0.2051 19.782404,-19.37066 43.00125,-42.59011 l 42.216085,-42.21718 -1.70166,-1.948928 c -3.071812,-3.51818 -3.817166,-4.316039 -4.032029,-4.316039 -0.428578,0 -85.034619,84.857937 -85.289701,85.543637 -1.070912,2.87874 0.868939,5.90155 3.78726,5.90155 0.678498,0 1.586959,-0.16782 2.018795,-0.37293 z M 154.75836,105.90635 c 8.69352,-5.52614 16.95641,-13.010744 23.7101,-21.476832 2.25355,-2.824934 7.41987,-10.312283 7.41987,-10.75333 0,-0.370963 -16.24482,-14.506313 -16.42986,-14.296366 -0.10381,0.117797 -0.7336,0.999053 -1.3995,1.958356 -7.64671,11.015777 -17.01105,20.46798 -27.64406,27.903434 -1.50748,1.054148 -2.74087,2.0234 -2.74087,2.153888 0,0.344737 13.9037,16.1391 14.21888,16.15241 0.14596,0.006 1.43541,-0.73254 2.86544,-1.64156 z M 131.64124,80.356244 c 9.82795,-6.587244 18.57189,-15.068396 25.21709,-24.459211 1.1795,-1.666839 2.4145,-3.488484 2.74443,-4.048101 L 160.20265,50.83144 143.976,36.525008 C 135.05135,28.656471 125.82341,20.518584 123.46949,18.440815 l -4.27988,-3.777768 -13.12773,13.129488 -13.127735,13.129489 14.495265,16.43731 c 20.11535,22.810383 21.64732,24.535324 21.79038,24.535324 0.0694,0 1.15906,-0.692285 2.42145,-1.538414 z m 19.78139,-56.331187 c 1.54973,-1.592408 2.07367,-2.583352 2.07367,-3.921973 0,-2.248582 -1.61799,-4.000289 -3.86721,-4.18681 -1.71155,-0.141938 -2.61639,0.309603 -4.56968,2.280416 l -1.56194,1.575943 3.14633,2.780279 c 1.73048,1.529157 3.22719,2.780285 3.32603,2.780285 0.0988,0 0.75259,-0.588662 1.4528,-1.30814 z\",\n    id: \"path73\"\n  }));\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgWhiteAxe, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/white-axe.db7db622.svg\";\nexport { ForwardRef as ReactComponent };","import React from \"react\";\nimport Button from \"react-bootstrap/Button\";\nimport Nav from \"react-bootstrap/Nav\";\nimport Navbar from \"react-bootstrap/Navbar\";\nimport NavDropdown from \"react-bootstrap/NavDropdown\";\nimport { LinkContainer } from \"react-router-bootstrap\";\nimport { withRouter } from \"react-router-dom\";\n\nimport { useDataContext } from \"./DataContext\";\nimport { ReactComponent as Logo } from \"./white-axe.svg\";\n\nfunction LogInWidget() {\n  let data = useDataContext();\n\n  if (!data.keyPair) {\n    return (\n      <Nav>\n        <LinkContainer to=\"/login\">\n          <Button active={false}>log in</Button>\n        </LinkContainer>\n      </Nav>\n    );\n  }\n  return (\n    <Nav>\n      <NavDropdown title={\"Logged in as \" + data.username} id=\"logoutdropdown\">\n        <NavDropdown.Item as=\"button\" onClick={() => data.app.logout()}>\n          Log out\n        </NavDropdown.Item>\n      </NavDropdown>\n    </Nav>\n  );\n}\n\nfunction Header(props: any) {\n  return (\n    <Navbar bg=\"dark\" variant=\"dark\" className=\"justify-content-between\">\n      <Nav>\n        <LinkContainer to=\"/\">\n          <Navbar.Brand>\n            <Logo\n              width=\"28\"\n              height=\"28\"\n              style={{\n                transform: \"scaleX(-1)\"\n              }}\n            />\n            <Navbar.Text style={{ width: \"10px\" }} />\n            Axboard\n          </Navbar.Brand>\n        </LinkContainer>\n      </Nav>\n      {props.location.pathname !== \"/login\" && <LogInWidget />}\n    </Navbar>\n  );\n}\n\nexport default withRouter(Header);\n","import React from \"react\";\nimport Card from \"react-bootstrap/Card\";\nimport { LinkContainer } from \"react-router-bootstrap\";\n\nimport { useDataContext } from \"./DataContext\";\nimport PostList from \"./PostList\";\n\nexport default function HomePage() {\n  let data = useDataContext();\n  let postlist = [];\n  for (let id in data.posts) {\n    let post = data.posts[id];\n    postlist.push(post);\n  }\n  postlist.sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime());\n\n  return (\n    <div>\n      <Card style={{ marginTop: \"10px\" }}>\n        <Card.Body>\n          <Card.Title>Home Page</Card.Title>\n          <LinkContainer to=\"/newpost/\">\n            <Card.Link>New Post</Card.Link>\n          </LinkContainer>\n        </Card.Body>\n      </Card>\n      <PostList posts={postlist} />\n    </div>\n  );\n}\n","import React from \"react\";\n\nexport default function Loading() {\n  return <div>loading...</div>;\n}\n","import React, { useState } from \"react\";\nimport { Redirect } from \"react-router-dom\";\n\nimport { useDataContext } from \"./DataContext\";\n\nexport default function LoginForm() {\n  let data = useDataContext();\n  let [username, setUsername] = useState(\"\");\n  let [passphrase, setPassphrase] = useState(\"\");\n\n  if (data.keyPair) {\n    // Already logged in\n    return <Redirect to=\"/\" />;\n  }\n\n  let handleSubmit = (e: any) => {\n    e.preventDefault();\n    // TODO: focus the first empty field if there is one\n    try {\n      data.app.login(username, passphrase);\n    } catch (e) {\n      // TODO: display this more nicely\n      alert(e);\n      setUsername(\"\");\n      setPassphrase(\"\");\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <label>\n        username:\n        <br />\n        <input\n          type=\"text\"\n          value={username}\n          onChange={e => setUsername(e.target.value)}\n        />\n      </label>\n      <br />\n      <label>\n        passphrase:\n        <br />\n        <input\n          type=\"password\"\n          value={passphrase}\n          onChange={e => setPassphrase(e.target.value)}\n        />\n      </label>\n      <input type=\"submit\" value=\"log in\" />\n    </form>\n  );\n}\n","import React, { useState } from \"react\";\nimport { Redirect } from \"react-router-dom\";\n\nimport { useDataContext } from \"./DataContext\";\n\nexport default function NewBoard() {\n  let [name, setName] = useState(\"\");\n  let [description, setDescription] = useState(\"\");\n  let [redirect, setRedirect] = useState(\"\");\n\n  let data = useDataContext();\n  if (!data.username) {\n    return <div>You must log in to create a new board.</div>;\n  }\n\n  if (redirect !== \"\") {\n    return <Redirect to={redirect} />;\n  }\n\n  let handleSubmit = async (e: any) => {\n    e.preventDefault();\n    if (name.length < 3) {\n      alert(\"name too short\");\n      return;\n    }\n    console.log(`creating board with name: ${name}`);\n    let board = await data.app.createBoard({ description }, name);\n    console.log(board);\n    setRedirect(`/b/${board.name}/${board.id}`);\n  };\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <label>\n        create a new board.\n        <br />\n        name:\n        <br />\n        <input\n          value={name}\n          onChange={e => setName(e.target.value.replace(/[\\W_]/g, \"\"))}\n        />\n      </label>\n      <label>\n        description:\n        <br />\n        <textarea\n          value={description}\n          onChange={e => setDescription(e.target.value)}\n        />\n      </label>\n      <input type=\"submit\" value=\"Submit\" />\n    </form>\n  );\n}\n","import React, { useState } from \"react\";\nimport { AxiomObject } from \"axiom-api\";\nimport { Link, Redirect } from \"react-router-dom\";\n\nimport { useDataContext } from \"./DataContext\";\n\nfunction BoardDropDown(props: {\n  boards: AxiomObject[];\n  selected?: string;\n  onSelect: (id: string) => void;\n}) {\n  let onChange = (e: any) => {\n    let value = e.target.value || undefined;\n    props.onSelect(value);\n  };\n  return (\n    <div>\n      <select value={props.selected} onChange={onChange}>\n        <option value=\"\" key=\"\">\n          select a board\n        </option>\n        {props.boards.map(board => (\n          <option value={board.id} key={board.id}>\n            {board.name}\n          </option>\n        ))}\n      </select>\n    </div>\n  );\n}\n\nexport default function NewPost(props: { board?: string }) {\n  let data = useDataContext();\n  let [id, setID] = useState(\"\");\n  let [content, setContent] = useState(\"\");\n  let [boardID, setBoardID] = useState(props.board);\n\n  if (id.length > 0) {\n    return <Redirect to={`/post/${id}`} />;\n  }\n\n  if (!data.username) {\n    return <div>log in to post</div>;\n  }\n  let author: string = data.username;\n\n  let handleSubmit = async (e: any) => {\n    e.preventDefault();\n    console.log(`posting ${content.length} bytes to ${boardID}`);\n    let post = await data.app.createPost({\n      author: author,\n      board: boardID || \"XXX\",\n      content: content\n    });\n    setID(post.id);\n  };\n\n  let boards = Object.values(data.boards);\n  boards.sort((a, b) => a.name.localeCompare(b.name));\n\n  return (\n    <div>\n      <form onSubmit={handleSubmit}>\n        <label>\n          New post:\n          <br />\n          {!props.board && (\n            <BoardDropDown\n              boards={boards}\n              selected={boardID}\n              onSelect={setBoardID}\n            />\n          )}\n          <textarea\n            value={content}\n            onChange={e => setContent(e.target.value)}\n          />\n        </label>\n        <input type=\"submit\" value=\"Submit\" />\n      </form>\n      <br />\n      <Link to=\"/newboard\">create a new board</Link>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { Link } from \"react-router-dom\";\n\nexport default function Page404() {\n  return (\n    <div>\n      <p>404 error: No page matches this URL.</p>\n      <br />\n      <Link to={\"/\"}>Return to the home page.</Link>\n    </div>\n  );\n}\n","import React, { useState } from \"react\";\n\nexport default function InputForm(props: {\n  onSubmit: (content: string) => void;\n  name: string;\n}) {\n  let [content, setContent] = useState(\"\");\n\n  let handleSubmit = (e: any) => {\n    e.preventDefault();\n    console.log(`submitting ${content}`);\n    props.onSubmit(content);\n    setContent(\"\");\n  };\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <label>\n        {props.name}:<br />\n        <textarea value={content} onChange={e => setContent(e.target.value)} />\n      </label>\n      <input type=\"submit\" value=\"Submit\" />\n    </form>\n  );\n}\n","import React from \"react\";\nimport { AxiomObject } from \"axiom-api\";\n\nimport { useDataContext } from \"./DataContext\";\nimport InputForm from \"./InputForm\";\n\nexport default function ReplyForm(props: { post: AxiomObject }) {\n  let data = useDataContext();\n  if (!data.username) {\n    return null;\n  }\n  let author: string = data.username;\n\n  return (\n    <InputForm\n      name={\"Reply\"}\n      onSubmit={async content => {\n        await data.app.createComment({\n          author,\n          board: props.post.data.board,\n          content,\n          parent: props.post.id\n        });\n      }}\n    />\n  );\n}\n","import React from \"react\";\nimport { Link } from \"react-router-dom\";\n\nimport { useDataContext } from \"./DataContext\";\nimport ReplyForm from \"./ReplyForm\";\nimport UserReference from \"./UserReference\";\nimport { ago } from \"./Util\";\n\nexport default function PostDetail(props: { id: string }) {\n  let data = useDataContext();\n  let post = data.posts[props.id];\n  if (!post) {\n    return <div>post not found</div>;\n  }\n  let cmap = data.comments[props.id];\n\n  let comments = [];\n  for (let key in cmap) {\n    comments.push(cmap[key]);\n  }\n  comments.sort((a, b) => a.timestamp.getTime() - b.timestamp.getTime());\n\n  let board = data.boards[post.data.board];\n\n  return (\n    <div>\n      <h2>Post Detail ({props.id})</h2>\n      <div>\n        posted by{\" \"}\n        <UserReference username={post.data.author} publicKey={post.owner} />{\" \"}\n        {ago(post.timestamp)}\n        {board && (\n          <div>\n            in{\" \"}\n            <Link to={`/b/${board.name}/${board.id}`}>{`b/${board.name}`}</Link>\n          </div>\n        )}\n      </div>\n      {post.data.content}\n      {comments.map((comment, index) => (\n        <p key={index}>\n          Comment: {comment.data.content}\n          <br />\n          by{\" \"}\n          <UserReference\n            username={comment.data.author}\n            publicKey={comment.owner}\n          />{\" \"}\n          ({ago(comment.timestamp)})\n        </p>\n      ))}\n      <ReplyForm post={post} />\n    </div>\n  );\n}\n","import React from \"react\";\n\nimport { useDataContext } from \"./DataContext\";\nimport PostList from \"./PostList\";\n\nexport default function UserDetail(props: { name: string; publicKey: string }) {\n  let data = useDataContext();\n\n  let postlist = [];\n  for (let id in data.posts) {\n    let post = data.posts[id];\n    if (post.owner === props.publicKey) {\n      postlist.push(post);\n    }\n  }\n  postlist.sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime());\n\n  return (\n    <div>\n      <h2>\n        posts from {props.name} ({props.publicKey}\n        ):\n      </h2>\n      <PostList posts={postlist} />\n    </div>\n  );\n}\n","import { AxiomObject } from \"axiom-api\";\n\nexport default class VoteSet {\n  // Karma for each user\n  karma: { [publicKey: string]: number };\n\n  // Score for each object voted on, not including the implicit self-vote\n  score: { [id: string]: number };\n\n  // Keyed by owner:target\n  votes: { [key: string]: AxiomObject };\n\n  constructor(votes: AxiomObject[]) {\n    this.karma = {};\n    this.score = {};\n    this.votes = {};\n\n    for (let vote of votes) {\n      this.addVote(vote);\n    }\n  }\n\n  modify(target: string, owner: string, delta: number) {\n    if (this.score[target]) {\n      this.score[target] += delta;\n    } else {\n      this.score[target] = delta;\n    }\n\n    if (this.karma[owner]) {\n      this.karma[owner] += delta;\n    } else {\n      this.karma[owner] = delta;\n    }\n  }\n\n  // Score which does include implicit self-vote\n  getScore(id: string): number {\n    return 1 + (this.score[id] || 0);\n  }\n\n  getKarma(publicKey: string): number {\n    return this.karma[publicKey] || 0;\n  }\n\n  getVote(owner: string, target: string): AxiomObject | null {\n    let key = `${owner}:${target}`;\n    return this.votes[key] || null;\n  }\n\n  addVote(vote: AxiomObject) {\n    if (Math.abs(vote.data.score) !== 1 || !vote.data.target) {\n      return;\n    }\n    let votee = vote.data.target.split(\":\")[0];\n    if (votee === vote.owner) {\n      // No self-votes\n      return;\n    }\n\n    let key = `${vote.owner}:${vote.data.target}`;\n    if (this.votes[key]) {\n      this.removeVote(this.votes[key]);\n    }\n    this.modify(vote.data.target, vote.owner, vote.data.score);\n    this.votes[key] = vote;\n  }\n\n  removeVote(vote: AxiomObject) {\n    let key = `${vote.owner}:${vote.data.target}`;\n    if (this.votes[key] !== vote) {\n      console.log(\"bad removeVote\");\n      return;\n    }\n\n    delete this.votes[key];\n    this.modify(vote.data.target, vote.owner, -vote.data.score);\n    vote.forget();\n  }\n}\n","import React from \"react\";\nimport Axiom, { AxiomObject, Channel, Database, KeyPair } from \"axiom-api\";\nimport { HashRouter as Router, Route, Switch } from \"react-router-dom\";\nimport Col from \"react-bootstrap/Col\";\nimport Container from \"react-bootstrap/Container\";\nimport Row from \"react-bootstrap/Row\";\n\nimport \"./App.css\";\nimport BoardPage from \"./BoardPage\";\nimport DataContext from \"./DataContext\";\nimport Header from \"./Header\";\nimport HomePage from \"./HomePage\";\nimport Loading from \"./Loading\";\nimport LoginForm from \"./LoginForm\";\nimport NewBoard from \"./NewBoard\";\nimport NewPost from \"./NewPost\";\nimport Page404 from \"./Page404\";\nimport PostDetail from \"./PostDetail\";\nimport UserDetail from \"./UserDetail\";\nimport { daysAgo } from \"./Util\";\nimport VoteSet from \"./VoteSet\";\n\ntype ObjectMap = { [id: string]: AxiomObject };\ntype CommentMap = { [parent: string]: ObjectMap };\ntype AppProps = {};\ntype AppState = {\n  posts: ObjectMap;\n  comments: CommentMap;\n  votes: VoteSet;\n  boards: ObjectMap;\n  keyPair?: KeyPair;\n  username?: string;\n  loading: boolean;\n};\n\nexport default class App extends React.Component<AppProps, AppState> {\n  channel: Channel;\n  postdb: Database;\n  commentdb: Database;\n  votedb: Database;\n  boarddb: Database;\n\n  constructor(props: AppProps) {\n    super(props);\n\n    let axiom = new Axiom({ network: \"prod\", verbose: true });\n    this.channel = axiom.channel(\"Axboard\");\n\n    this.postdb = this.channel.database(\"Posts\");\n    this.commentdb = this.channel.database(\"Comments\");\n    this.votedb = this.channel.database(\"Votes\");\n    this.boarddb = this.channel.database(\"Boards\");\n\n    let ageFilter = (obj: AxiomObject): boolean => {\n      let age = daysAgo(obj.timestamp);\n      if (age > 2 || age < -0.05) {\n        return false;\n      }\n      return true;\n    };\n\n    this.postdb.useFilter(ageFilter);\n    this.commentdb.useFilter(ageFilter);\n    this.votedb.useFilter(ageFilter);\n\n    this.state = {\n      posts: {},\n      comments: {},\n      votes: new VoteSet([]),\n      boards: {},\n      keyPair: undefined,\n      username: undefined,\n      loading: true\n    };\n\n    // Async but we can't wait for a response in this constructor\n    this.loadData();\n\n    // Must be async because it can call setState. TODO: refactor and avoid\n    setTimeout(() => {\n      let username = window.localStorage.getItem(\"username\");\n      let passphrase = window.localStorage.getItem(\"passphrase\");\n      if (username && passphrase) {\n        this.login(username, passphrase);\n      }\n    }, 0);\n  }\n\n  async loadData(): Promise<void> {\n    await this.postdb.waitForLoad();\n    await this.commentdb.waitForLoad();\n    await this.votedb.waitForLoad();\n    await this.boarddb.waitForLoad();\n\n    let postlist = await this.postdb.find({ selector: {} });\n    let posts: ObjectMap = {};\n    for (let post of postlist) {\n      posts[post.id] = post;\n    }\n\n    let commentlist = await this.commentdb.find({ selector: {} });\n    let comments: CommentMap = {};\n    for (let comment of commentlist) {\n      let parent = comment.data.parent;\n      if (!comments[parent]) {\n        comments[parent] = {};\n      }\n      comments[parent][comment.id] = comment;\n    }\n\n    let votelist = await this.votedb.find({ selector: {} });\n    let votes = new VoteSet(votelist);\n\n    let boardlist = await this.boarddb.find({ selector: {} });\n    let boards: ObjectMap = {};\n    for (let board of boardlist) {\n      boards[board.id] = board;\n    }\n\n    this.setState({\n      posts,\n      comments,\n      votes,\n      boards,\n      loading: false\n    });\n  }\n\n  async createPost(args: {\n    author: string;\n    board: string;\n    content: string;\n  }): Promise<AxiomObject> {\n    let post = await this.postdb.create(args);\n    this.setState(state => {\n      let newPosts = { ...state.posts };\n      newPosts[post.id] = post;\n      return { ...state, posts: newPosts };\n    });\n    return post;\n  }\n\n  async createComment(args: {\n    author: string;\n    board: string;\n    content: string;\n    parent: string;\n  }): Promise<AxiomObject> {\n    let comment = await this.commentdb.create(args);\n    this.setState(state => {\n      let newCommentSubmap = { ...state.comments[args.parent] };\n      newCommentSubmap[comment.id] = comment;\n      let newComments = { ...state.comments };\n      newComments[args.parent] = newCommentSubmap;\n      return { ...state, comments: newComments };\n    });\n    return comment;\n  }\n\n  async createBoard(\n    args: {\n      description: string;\n    },\n    name: string\n  ): Promise<AxiomObject> {\n    let board = await this.boarddb.create(args, name);\n    this.setState(state => {\n      let newBoards = { ...state.boards };\n      newBoards[board.id] = board;\n      return { ...state, boards: newBoards };\n    });\n    return board;\n  }\n\n  async vote(args: { target: string; score: number }): Promise<AxiomObject> {\n    let vote = await this.votedb.create(args);\n    this.state.votes.addVote(vote);\n    this.forceUpdate();\n    return vote;\n  }\n\n  async upvote(target: string): Promise<AxiomObject> {\n    return await this.vote({ target, score: 1 });\n  }\n\n  async downvote(target: string): Promise<AxiomObject> {\n    return await this.vote({ target, score: -1 });\n  }\n\n  login(username: string, passphrase: string) {\n    let regex = /^[A-Za-z0-9_]+$/;\n    if (!regex.test(username)) {\n      throw new Error(`invalid username: ${username}`);\n    }\n    let keyPair = KeyPair.fromSecretPhrase(username + \";\" + passphrase);\n    this.channel.setKeyPair(keyPair);\n    this.setState({ keyPair, username });\n\n    // Save to local storage\n    window.localStorage.setItem(\"username\", username);\n    window.localStorage.setItem(\"passphrase\", passphrase);\n  }\n\n  logout() {\n    this.channel.setKeyPair(null);\n    this.setState({ keyPair: undefined });\n    window.localStorage.removeItem(\"username\");\n    window.localStorage.removeItem(\"passphrase\");\n  }\n\n  render() {\n    if (this.state.loading) {\n      return <Loading />;\n    }\n\n    return (\n      <DataContext.Provider\n        value={{\n          app: this,\n          posts: this.state.posts,\n          comments: this.state.comments,\n          votes: this.state.votes,\n          boards: this.state.boards,\n          username: this.state.username,\n          keyPair: this.state.keyPair\n        }}\n      >\n        <Router>\n          <Header />\n          <Container>\n            <Row>\n              <Col>\n                <Switch>\n                  <Route\n                    path=\"/post/:id\"\n                    render={({ match }) => <PostDetail id={match.params.id} />}\n                  />\n                  <Route\n                    path=\"/u/:name/:publicKey\"\n                    render={({ match }) => (\n                      <UserDetail\n                        name={match.params.name}\n                        publicKey={match.params.publicKey}\n                      />\n                    )}\n                  />\n                  <Route\n                    path=\"/b/:name/:id\"\n                    render={({ match }) => (\n                      <BoardPage\n                        name={match.params.name}\n                        id={match.params.id}\n                      />\n                    )}\n                  />\n                  <Route path=\"/login\">\n                    <LoginForm />\n                  </Route>\n                  <Route path=\"/newboard\">\n                    <NewBoard />\n                  </Route>\n                  <Route\n                    path=\"/newpost/:board\"\n                    render={({ match }) => (\n                      <NewPost board={match.params.board} />\n                    )}\n                  />\n                  <Route path=\"/newpost\">\n                    <NewPost />\n                  </Route>\n                  <Route path=\"/\" exact>\n                    <HomePage />\n                  </Route>\n                  <Route>\n                    <Page404 />\n                  </Route>\n                </Switch>\n              </Col>\n            </Row>\n          </Container>\n        </Router>\n      </DataContext.Provider>\n    );\n  }\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport \"bootstrap/dist/css/bootstrap.css\";\n\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}