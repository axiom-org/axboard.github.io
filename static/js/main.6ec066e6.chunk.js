(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{124:function(t,n){},253:function(t,n,e){t.exports=e(523)},258:function(t,n,e){},280:function(t,n){},320:function(t,n){},322:function(t,n){},335:function(t,n){},337:function(t,n){},345:function(t,n){},347:function(t,n){},357:function(t,n){},359:function(t,n){},367:function(t,n){},369:function(t,n){},377:function(t,n){},378:function(t,n){},380:function(t,n){},382:function(t,n){},384:function(t,n){},397:function(t,n){},402:function(t,n){},404:function(t,n){},413:function(t,n){},417:function(t,n){},418:function(t,n){},419:function(t,n){},426:function(t,n){},428:function(t,n){},433:function(t,n){},437:function(t,n){},438:function(t,n){},441:function(t,n){},447:function(t,n){},450:function(t,n){},452:function(t,n){},464:function(t,n){},466:function(t,n){},477:function(t,n){},479:function(t,n){},493:function(t,n){},495:function(t,n){},508:function(t,n){},510:function(t,n){},517:function(t,n){},521:function(t,n,e){},523:function(t,n,e){"use strict";e.r(n);var a,o=e(7),r=e.n(o),i=e(247),c=e.n(i),u=(e(258),e(22)),s=e.n(u),l=e(66),m=e(248),f=e(249),p=e(251),d=e(250),h=e(252),v=e(79),b=e.n(v),w=(e(521),e(80));function y(t){var n=Object(o.useState)(""),e=Object(w.a)(n,2),a=e[0],i=e[1];return r.a.createElement("form",{onSubmit:function(n){n.preventDefault(),console.log("submitting ".concat(a)),t.onSubmit(a),i("")}},r.a.createElement("label",null,t.name,":",r.a.createElement("br",null),r.a.createElement("input",{type:t.password?"password":"text",value:a,onChange:function(t){return i(t.target.value)}})),r.a.createElement("input",{type:"submit",value:"Submit"}))}function E(){return r.a.createElement("div",null,"loading...")}function g(t){return r.a.createElement(y,{name:"Log in with your passphrase to post or comment",password:!0,onSubmit:function(n){var e=v.KeyPair.fromSecretPhrase(n);t.onSubmit(e)}})}function k(t){var n=Object(o.useState)(t.comments),e=Object(w.a)(n,2),a=e[0],i=e[1];return r.a.createElement("div",null,r.a.createElement("hr",null),r.a.createElement("p",null,"Post: ",t.post.data.content),a.map(function(t,n){return r.a.createElement("p",{key:n},"Comment: ",t.data.content)}),t.allowReply&&r.a.createElement(y,{name:"Reply",onSubmit:function(){var n=Object(l.a)(s.a.mark(function n(e){var o,r,c;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return o=t.post.id,r={parent:o,content:e},n.next=4,t.commentdb.create(r);case 4:c=n.sent,i([c].concat(a));case 6:case"end":return n.stop()}},n)}));return function(t){return n.apply(this,arguments)}}()}))}!function(t){t[t.Initial=1]="Initial",t[t.Main=2]="Main"}(a||(a={}));var S=function(t){function n(t){var e;Object(m.a)(this,n),(e=Object(p.a)(this,Object(d.a)(n).call(this,t))).channel=void 0,e.postdb=void 0,e.commentdb=void 0;var o=new b.a({network:"alpha",verbose:!0}).createNode();return e.channel=o.channel("Axboard"),e.postdb=e.channel.database("Posts"),e.commentdb=e.channel.database("Comments"),e.state={screen:a.Initial,posts:[],comments:{},keyPair:void 0,loading:!1},setTimeout(function(){e.loadMainView()},0),e}return Object(h.a)(n,t),Object(f.a)(n,[{key:"sortedComments",value:function(t){var n=[];for(var e in this.state.comments[t])n.push(this.state.comments[t][e]);return n.sort(function(t,n){return t.timestamp.getTime()-n.timestamp.getTime()}),n}},{key:"loadMainView",value:function(){var t=Object(l.a)(s.a.mark(function t(){var n,e,o,r,i,c,u,l,m,f;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.setState({loading:!0}),t.next=3,this.postdb.find({selector:{}});case 3:return(n=t.sent).sort(function(t,n){return n.timestamp.getTime()-t.timestamp.getTime()}),t.next=7,this.commentdb.find({selector:{}});case 7:for(e=t.sent,o={},r=!0,i=!1,c=void 0,t.prev=12,u=e[Symbol.iterator]();!(r=(l=u.next()).done);r=!0)m=l.value,f=m.data.parent,o[f]||(o[f]={}),o[f][m.id]=m;t.next=20;break;case 16:t.prev=16,t.t0=t.catch(12),i=!0,c=t.t0;case 20:t.prev=20,t.prev=21,r||null==u.return||u.return();case 23:if(t.prev=23,!i){t.next=26;break}throw c;case 26:return t.finish(23);case 27:return t.finish(20);case 28:this.setState({screen:a.Main,posts:n,comments:o,loading:!1});case 29:case"end":return t.stop()}},t,this,[[12,16,20,28],[21,,23,27]])}));return function(){return t.apply(this,arguments)}}()},{key:"renderHeader",value:function(){var t=this;return this.state.keyPair?r.a.createElement("div",null,r.a.createElement("p",null,"logged in as ",this.state.keyPair.getPublicKey()),r.a.createElement(y,{name:"New post",onSubmit:function(){var n=Object(l.a)(s.a.mark(function n(e){var a,o;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a={content:e},n.next=3,t.postdb.create(a);case 3:o=n.sent,t.setState(function(t){return{posts:[o].concat(t.posts)}});case 5:case"end":return n.stop()}},n)}));return function(t){return n.apply(this,arguments)}}()})):r.a.createElement(g,{onSubmit:function(n){t.channel.setKeyPair(n),t.setState({keyPair:n})}})}},{key:"render",value:function(){var t=this;return this.state.screen===a.Initial?r.a.createElement(E,null):r.a.createElement("div",null,r.a.createElement("h1",null,"P2P Message Board Proof Of Concept"),this.renderHeader(),this.state.posts.map(function(n,e){return r.a.createElement(k,{key:e,post:n,comments:t.sortedComments(n.id),commentdb:t.commentdb,allowReply:!!t.state.keyPair})}))}}]),n}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(S,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[253,1,2]]]);
//# sourceMappingURL=main.6ec066e6.chunk.js.map