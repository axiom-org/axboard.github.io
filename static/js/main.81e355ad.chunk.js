(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{118:function(e,t){},246:function(e,t,n){e.exports=n(514)},251:function(e,t,n){},252:function(e,t,n){},273:function(e,t){},311:function(e,t){},313:function(e,t){},326:function(e,t){},328:function(e,t){},336:function(e,t){},338:function(e,t){},348:function(e,t){},350:function(e,t){},358:function(e,t){},360:function(e,t){},368:function(e,t){},369:function(e,t){},371:function(e,t){},373:function(e,t){},375:function(e,t){},388:function(e,t){},393:function(e,t){},395:function(e,t){},404:function(e,t){},408:function(e,t){},409:function(e,t){},410:function(e,t){},417:function(e,t){},419:function(e,t){},424:function(e,t){},428:function(e,t){},429:function(e,t){},432:function(e,t){},438:function(e,t){},441:function(e,t){},443:function(e,t){},455:function(e,t){},457:function(e,t){},470:function(e,t){},472:function(e,t){},486:function(e,t){},488:function(e,t){},501:function(e,t){},503:function(e,t){},510:function(e,t){},514:function(e,t,n){"use strict";n.r(t);var o=n(10),a=n.n(o),c=n(239),s=n.n(c),i=(n(251),n(243)),r=n(75),u=n(240),m=n(241),l=n(244),f=n(242),p=n(245),d=(n(252),n(99)),b=n.n(d);var v=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(l.a)(this,Object(f.a)(t).call(this,e))).postdb=void 0,n.commentdb=void 0,n.channel=void 0,n.postdb=e.postdb,n.commentdb=e.commentdb,n.channel=e.channel,n.state={posts:{},comments:{},keyPair:void 0},n.postdb.onMessage(function(e){if("Delete"!==e.message.type){var t=e.signer+":"+e.message.id,o=Object(r.a)({},n.state.posts);o[t]=e,n.setState({posts:o})}}),n.commentdb.onMessage(function(e){if("Delete"!==e.message.type){var t=e.signer+":"+e.message.id,o=e.message.data.parent,a=Object(r.a)({},n.state.comments[o]);a[t]=e;var c=Object(r.a)({},n.state.comments);c[o]=a,n.setState({comments:c})}}),n}return Object(p.a)(t,e),Object(m.a)(t,[{key:"sortedPosts",value:function(){var e=[];for(var t in this.state.posts)e.push(this.state.posts[t]);return e.sort(function(e,t){return t.message.timestamp.localeCompare(e.message.timestamp)}),e}},{key:"sortedComments",value:function(e){var t=[];for(var n in this.state.comments[e])t.push(this.state.comments[e][n]);return t.sort(function(e,t){return e.message.timestamp.localeCompare(t.message.timestamp)}),t}},{key:"renderHeader",value:function(){var e=this;return this.state.keyPair?a.a.createElement("div",null,a.a.createElement("p",null,"logged in as ",this.state.keyPair.getPublicKey()),a.a.createElement(g,{name:"New post",onSubmit:function(t){var n={content:t};e.postdb.create(n)}})):a.a.createElement(y,{onSubmit:function(t){e.channel.setKeyPair(t),e.setState({keyPair:t})}})}},{key:"render",value:function(){var e=this;return a.a.createElement("div",null,a.a.createElement("h1",null,"P2P Message Board Proof Of Concept"),this.renderHeader(),this.sortedPosts().map(function(t,n){return a.a.createElement(h,{key:n,post:t,comments:e.sortedComments(t.signer+":"+t.message.id),commentdb:e.commentdb,allowReply:!!e.state.keyPair})}))}}]),t}(a.a.Component);function h(e){return a.a.createElement("div",null,a.a.createElement("hr",null),a.a.createElement("p",null,"Post: ",e.post.message.data.content),e.comments.map(function(e,t){return a.a.createElement("p",{key:t},"Comment: ",e.message.data.content)}),e.allowReply&&a.a.createElement(g,{name:"Reply",onSubmit:function(t){var n={parent:e.post.signer+":"+e.post.message.id,content:t};e.commentdb.create(n)}}))}function g(e){var t=Object(o.useState)(""),n=Object(i.a)(t,2),c=n[0],s=n[1];return a.a.createElement("form",{onSubmit:function(t){t.preventDefault(),console.log("submitting ".concat(c)),e.onSubmit(c),s("")}},a.a.createElement("label",null,e.name,":",a.a.createElement("br",null),a.a.createElement("input",{type:e.password?"password":"text",value:c,onChange:function(e){return s(e.target.value)}})),a.a.createElement("input",{type:"submit",value:"Submit"}))}function y(e){return a.a.createElement(g,{name:"Log in with your passphrase to post or comment",password:!0,onSubmit:function(t){var n=d.KeyPair.fromSecretPhrase(t);e.onSubmit(n)}})}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(a.a.createElement(function(){var e=new b.a({network:"alpha",verbose:!0}).createNode().channel("Axboard"),t=e.database("Posts"),n=e.database("Comments");return a.a.createElement("div",{className:"App"},a.a.createElement(v,{postdb:t,commentdb:n,channel:e}))},null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[246,1,2]]]);
//# sourceMappingURL=main.81e355ad.chunk.js.map